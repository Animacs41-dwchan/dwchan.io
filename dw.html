<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dwchan - /dw/ Dandy's World Random</title>
    <style>
        /* TEMA REGULAR 2.0 (4CHAN 2007) */
        body {
            font-family: Arial, Helvetica, sans-serif;
            font-size: 10pt;
            background-color: #FFFFEE; /* Amarelo pálido, clássico 4chan */
            color: #000000;
            margin: 0;
            padding: 20px;
        }
        #container {
            width: 90%; 
            max-width: 900px;
            margin: 0 auto; 
            padding: 10px;
        }

        /* Board Header */
        .board-header h1 {
            font-size: 18pt;
            color: #CC0000; 
            margin: 5px 0 10px 0;
            border-bottom: 2px solid #CC0000;
            padding-bottom: 5px;
            text-align: left;
        }

        /* Navigation */
        .navmenu {
            text-align: center;
            font-size: 10pt;
            padding: 5px 0 15px 0;
            border-bottom: 1px solid #C0C0C0;
        }
        .navmenu a {
            color: #0000FF;
            text-decoration: none;
            font-weight: bold;
            padding: 0 5px;
        }
        .navmenu a:visited { color: #551A8B; }
        .navmenu a:hover { color: #CC0000; text-decoration: underline; }

        /* Estilo da Thread/Post */
        .thread {
            margin-top: 20px;
            border: 1px solid #BBBBBB; 
            padding: 15px;
            background-color: #FFFFFF;
        }
        .post {
            border: 1px solid #CCCCCC;
            padding: 10px;
            margin-bottom: 10px;
            background-color: #F0E0D6; /* Cor de postagem tradicional */
        }
        .post-info {
            color: #800000; /* Cor vermelha escura para informações */
            font-weight: bold;
            font-size: 10pt;
            margin-bottom: 5px;
        }
        .post-id {
            color: #008000; /* ID de cor verde, crucial para a estética */
            font-weight: bold;
        }
        .post-content {
            margin-top: 5px;
            line-height: 1.5;
            white-space: pre-wrap; /* Mantém quebras de linha no conteúdo */
        }
        
        /* Área de Postagem */
        .new-thread-form {
            border: 1px solid #BBBBBB;
            padding: 15px;
            background-color: #F0F0F0;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        .new-thread-form input[type="text"], .new-thread-form textarea {
            width: 98%;
            padding: 5px;
            margin-bottom: 10px;
            border: 1px solid #CCCCCC;
        }
        .new-thread-form input[type="submit"] {
            background-color: #CC0000;
            color: white;
            padding: 5px 15px;
            border: none;
            cursor: pointer;
            font-weight: bold;
        }
        
        /* Mensagem de Board Vazia */
        .empty-board {
            text-align: center;
            padding: 50px 0;
            font-size: 14pt;
            color: #888888;
        }
    </style>
</head>
<body onload="loadPosts()">
    <div id="container">
        
        <div class="board-header">
            <h1>/dw/ - Dandy's World Random</h1>
        </div>

        <div class="navmenu">
            [ <a href="/dwchan.io/">INDEX</a> / 
            <a href="/dwchan.io/dw.html" style="color: #CC0000; font-weight: bold;">/dw/</a> /
            <a href="/dwchan.io/lr.html">/lr/</a> /
            <a href="/dwchan.io/ship.html">/ship/</a> /
            <a href="/dwchan.io/r34.html">/r34/</a> /
            <a href="/dwchan.io/pol.html">/pol/</a> /
            <a href="/dwchan.io/rules_full.html">REGRAS (0-70)</a> ]
        </div>

        <div class="new-thread-form">
            <h2>Criar Nova Thread</h2>
            <form id="postForm" onsubmit="savePost(event)">
                Nome: <input type="text" name="name" value="Anônimo (Toon)" placeholder="Opcional"><br>
                Assunto: <input type="text" name="subject" placeholder="Assunto da thread"><br>
                Comentário: <textarea name="comment" rows="6" placeholder="O caos é permitido aqui (Regra 20)" required></textarea><br>
                Arquivo: <input type="file" name="file"><br>
                <input type="submit" value="Postar">
            </form>
            
            <p style="font-size: 9pt; color: #800000; margin-top: 10px;">
                Seu Toon ID: <span class="post-id generated-id">Calculando...</span> (Muda a cada carregamento de página - Regra 3)
            </p>
        </div>

        <p style="font-size: 10pt; text-align: right; color: #888;">[ <a href="#">Página Seguinte</a> ]</p>

        <div id="thread-display">
            <div class="empty-board" id="empty-message">
                Esta board está vazia. Seja o primeiro a criar uma thread!
            </div>
        </div>
        
        <hr style="border: 0; height: 1px; background-color: #C0C0C0; margin: 30px 0 15px 0;">

        <div style="text-align: center; font-size: 8pt; color: #888888;">
            dwchan v0.8 (Alpha/Beta) | Hospedado via <a href="https://pages.github.com/">GitHub Pages</a>. | &copy; 2025 animacs41.
        </div>
    </div>

    <script>
        const LOCAL_STORAGE_KEY = 'dwchan_dw_posts';

        function generateToonID() {
            // Gera um número hexadecimal de 8 caracteres (Ex: AABBCCDD)
            return Math.floor(Math.random() * 0xFFFFFFFF).toString(16).padStart(8, '0').toUpperCase();
        }

        function getCurrentDate() {
            const now = new Date();
            const date = now.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit', year: 'numeric' });
            const time = now.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
            return `${date} ${time}`;
        }
        
        function savePost(event) {
            event.preventDefault(); // Impede o envio tradicional do formulário

            const form = document.getElementById('postForm');
            const name = form.elements['name'].value;
            const subject = form.elements['subject'].value;
            const comment = form.elements['comment'].value;
            
            if (!comment) {
                // Mantém o alerta de validação, pois o comentário é obrigatório.
                alert('O campo Comentário é obrigatório.');
                return;
            }

            const currentID = document.querySelector('.generated-id').textContent;
            
            const newPost = {
                name: name === 'Anônimo (Toon)' ? 'Anônimo (Toon)' : name,
                subject: subject,
                comment: comment,
                id: currentID,
                date: getCurrentDate()
            };

            // 1. Carrega posts existentes
            let posts = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY)) || [];
            
            // 2. Adiciona o novo post ao início da lista (posts mais novos no topo)
            posts.unshift(newPost);
            
            // Limita o número de posts (ex: 20 posts)
            if (posts.length > 20) {
                posts = posts.slice(0, 20);
            }

            // 3. Salva a lista atualizada no Local Storage
            localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(posts));

            // 4. Recarregamento para exibir o novo post
            // REMOVIDO O ALERT. A recarga agora é silenciosa, simulando o envio.
            window.location.reload(); 
        }

        function loadPosts() {
            // Inicializa o Toon ID
            const randomID = generateToonID();
            document.querySelectorAll('.generated-id').forEach(element => {
                element.textContent = randomID;
            });

            // Carrega e exibe os posts
            const posts = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY));
            const display = document.getElementById('thread-display');
            const emptyMessage = document.getElementById('empty-message');
            
            if (posts && posts.length > 0) {
                if (emptyMessage) {
                    emptyMessage.style.display = 'none';
                }

                // Cria o contêiner da thread (simulada)
                const threadDiv = document.createElement('div');
                threadDiv.className = 'thread';

                posts.forEach(post => {
                    const postDiv = document.createElement('div');
                    postDiv.className = 'post';

                    // Conteúdo do cabeçalho do post
                    const infoHTML = `
                        <div class="post-info">
                            <span style="color: #000000;">${post.name}</span> 
                            ${post.date} 
                            No. 
                            <span class="post-id">${post.id}</span> 
                            [ <a href="#" onclick="alert('Funcionalidade de resposta não implementada em site estático.'); return false;">Responder</a> ]
                        </div>
                        <div class="post-content">
                            ${post.subject ? `<b>Assunto: ${post.subject}</b><br><br>` : ''}
                            ${post.comment}
                        </div>
                    `;
                    postDiv.innerHTML = infoHTML;
                    threadDiv.appendChild(postDiv);
                });

                display.appendChild(threadDiv);

            } else {
                 if (emptyMessage) {
                    emptyMessage.style.display = 'block';
                }
            }
        }
    </script>
</body>
</html>
